# Test info

- Name: Civic Auth Applications >> should complete full embedded login and logout flow
- Location: /home/runner/work/civic-auth-examples/civic-auth-examples/packages/e2e/playwright/tests/civic-auth/vanillajs-login.spec.ts:10:7

# Error details

```
Error: browserType.launch: Executable doesn't exist at /home/runner/.cache/ms-playwright/webkit-2158/pw_run.sh
╔═════════════════════════════════════════════════════════════════════════╗
║ Looks like Playwright Test or Playwright was just installed or updated. ║
║ Please run the following command to download new browsers:              ║
║                                                                         ║
║     yarn playwright install                                             ║
║                                                                         ║
║ <3 Playwright Team                                                      ║
╚═════════════════════════════════════════════════════════════════════════╝
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 | import { allure } from 'allure-playwright';
   3 |
   4 | test.describe('Civic Auth Applications', () => {
   5 |   test.beforeEach(async ({ page }) => {
   6 |     await allure.epic('Civic Auth Applications');
   7 |     await allure.suite('Login');
   8 |     await allure.feature('VanillaJS Embedded Login');
   9 |   });
> 10 |   test('should complete full embedded login and logout flow', async ({ page, browserName }) => {
     |       ^ Error: browserType.launch: Executable doesn't exist at /home/runner/.cache/ms-playwright/webkit-2158/pw_run.sh
  11 |     // Open the app home page
  12 |     await page.goto('http://localhost:3000');
  13 |
  14 |     // Wait for the page to fully load with all UI elements
  15 |     await page.waitForLoadState('networkidle');
  16 |     await page.waitForLoadState('domcontentloaded');
  17 |     
  18 |     // Click the embedded sign in button
  19 |     await page.click('#loginButton');
  20 |     
  21 |     // Chrome/Firefox use iframe flow
  22 |     // Wait for iframe to appear and load inside the authContainer
  23 |     await page.waitForSelector('#authContainer #civic-auth-iframe', { timeout: 30000 });
  24 |     
  25 |     // Click log in with dummy in the iframe
  26 |     const frame = page.frameLocator('#authContainer #civic-auth-iframe');
  27 |     
  28 |     // Try to wait for the frame to load completely first
  29 |     await frame.locator('body').waitFor({ timeout: 30000 });
  30 |     
  31 |     // Look for the dummy button
  32 |     const dummyButton = frame.locator('[data-testid="civic-login-oidc-button-dummy"]');
  33 |     await dummyButton.click({ timeout: 20000 });
  34 |
  35 |     // Wait for the iframe to be gone (indicating login is complete)
  36 |     await page.waitForSelector('#authContainer #civic-auth-iframe', { state: 'hidden', timeout: 20000 });
  37 |     
  38 |     // Confirm logged in state by checking for user info display
  39 |     await page.getByRole('button', { name: 'Sign Out' }).click();
  40 |     await page.getByRole('button', { name: 'Sign In' });
  41 |     
  42 |     // Verify token refresh fails after logout
  43 |     const response = await page.request.post('https://auth-dev.civic.com/oauth/token', {
  44 |       form: {
  45 |         grant_type: 'refresh_token',
  46 |         refresh_token: 'storedRefreshToken', // Note: You'll need to get the actual refresh token
  47 |         client_id: process.env.CLIENT_ID || ''
  48 |       }
  49 |     });
  50 |     expect(response.status()).toBe(400);
  51 |   });
  52 | }); 
```